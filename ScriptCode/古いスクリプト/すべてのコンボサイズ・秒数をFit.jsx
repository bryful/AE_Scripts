(function (me){	if ( app.preferences.getPrefAsLong("Main Pref Section", "Pref_SCRIPTING_FILE_NETWORK_SECURITY") != 1){		var s = "すみません。以下の設定がオフになっています。\r\n\r\n";		s +=  "「環境設定：一般設定：スクリプトによるファイルへの書き込みとネットワークへのアクセスを許可」\r\n";		s += "\r\n";		s += "このスクリプトを使う為にはオンにする必要が有ります。\r\n";		alert(s);		return;	}	function getFileNameWithoutExt(s)	{		var ret = s;		var idx = ret.lastIndexOf(".");		if ( idx>=0){			ret = ret.substring(0,idx);		}		return ret;	}	function getScriptName()	{		var ary = $.fileName.split("/");		return File.decode( getFileNameWithoutExt(ary[ary.length-1]));	}	function getScriptPath()	{		var s = $.fileName;		return s.substring(0,s.lastIndexOf("/"));	}	var scriptName = getScriptName();var compWidth =0;var compHeight =0;var compDuration =0;//*************************//MainWindowvar winObj = ( me instanceof Panel) ? me : new Window("palette", scriptName, [0,0,0+224,0+150]  ,{resizeable:true, maximizeButton:true, minimizeButton:true});//*************************//controlsvar posY= 12;var btnGetInfoComp = winObj.add("button",[12, posY, 12+200, posY+24],"コンポ情報獲得");posY+= 30;var btnGetInfoLayer = winObj.add("button",[12, posY, 12+200, posY+24],"レイヤ情報獲得");posY+= 30;var stInfo = winObj.add("statictext",[12, posY, 12+200, posY+24],"未獲得");posY+= 30;var btnExec = winObj.add("button",[12, posY, 12+200, posY+24],"サイズ秒数を設定");var geCompInfo = function(){	compWidth =0;	compHeight =0;	compDuration =0;	stInfo.text ="未獲得";	var ac = app.project.activeItem;	if (( ac instanceof CompItem)==false)	{		alert("コンポが選択されていません！");		return;	}	compWidth = ac.width;	compHeight = ac.height;	compDuration = ac.duration;		var str = "W:" + compWidth + "H:" + compHeight + " " + Math.floor(compDuration*ac.frameRate) +"f /" + cmp.name;	stInfo.text = str;	}var geLayerInfo = function(){	compWidth =0;	compHeight =0;	compDuration =0;	stInfo.text ="未獲得";	var ac = app.project.activeItem;	if (( ac instanceof CompItem)==false)	{		alert("コンポがアクティブじゃない！");		return;	}	var sel = ac.selectedLayers;	if (sel.length!=1){		alert("レイヤは1個だけ");		return;	}	var target = sel[0];	if (target.source == null)	{		alert("無効なレイヤです");		return;	}	compWidth = target.source.width;	compHeight = target.source.height;	compDuration = target.source.duration;		var str = "W:" + compWidth + "H:" + compHeight + " " + Math.floor(compDuration*ac.frameRate) +"f/ " + target.source.name;	stInfo.text = str;	}var getComps=function(){	var ret = [];	var targets = app.project.selection;	if (targets.length<=0) {		alert("何も選択されていません！");		return ret;	}	for ( var i=0; i<targets.length; i++)	{		if ( (targets[i] instanceof CompItem)==true)		{			ret.push(targets[i]);		}	}	if (ret.length<=0) {		alert("コンポが選択されていません！");		return ret;	}	return ret;}var resizeExec = function(cmp){	if ( cmp.numLayers<=0) {		return;	}	var lyrs = [];	for ( var i=1; i<=cmp.numLayers;i++)	{		var lyr = cmp.layers[i];		if (lyr.parent ==null)		{			lyrs.push(lyr);		}	}	if (lyrs.length<=0) return;	var nl = cmp.layers.addNull(cmp.duration);	for (var i=0; i<lyrs.length;i++)	{		lyrs[i].parent = nl;	}	cmp.width = compWidth;	cmp.height = compHeight;	cmp.duration = compDuration;	nl.property("ADBE Transform Group").property("ADBE Position").setValue([compWidth/2,cmp.height/2]);	for (var i=0; i<lyrs.length;i++)	{		try{						if (lyrs[i].locked==false){				lyrs[i].parent = null;				lyrs[i].outPoint = compDuration;			}else{				alert(cmp.name +"/" +lyrs[i].name +" is Loacked!");			}		}catch(e){			alert(e.toString());		}	}	nl.source.remove();
}var exec = function(){	if ( (compWidth<=0)&&(compHeight<=0)&&(compDuration<=0))	{		alert("元となるパラメータが獲得されていません！");		return;	}	app.beginUndoGroup("チュルチュル");	var targets = getComps();	if (targets.length>0)	{		for (var i=0; i<targets.length; i++)		{			resizeExec(targets[i]);		}	}	app.endUndoGroup();	compWidth =0;	compHeight =0;	compDuration =0;	stInfo.text ="未獲得";}btnGetInfoComp.onClick = geCompInfo;btnGetInfoLayer.onClick = geLayerInfo;btnExec.onClick = exec;//window show	if ( ( me instanceof Panel) == false){		winObj.center(); 		winObj.show();	}})(this);