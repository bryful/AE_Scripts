(function (me){	if ( app.preferences.getPrefAsLong("Main Pref Section", "Pref_SCRIPTING_FILE_NETWORK_SECURITY") != 1){		var s = "すみません。以下の設定がオフになっています。\r\n\r\n";		s +=  "「環境設定：一般設定：スクリプトによるファイルへの書き込みとネットワークへのアクセスを許可」\r\n";		s += "\r\n";		s += "このスクリプトを使う為にはオンにする必要が有ります。\r\n";		alert(s);		return;	}	function getFileNameWithoutExt(s)	{		var ret = s;		var idx = ret.lastIndexOf(".");		if ( idx>=0){			ret = ret.substring(0,idx);		}		return ret;	}	function getScriptName()	{		var ary = $.fileName.split("/");		return File.decode( getFileNameWithoutExt(ary[ary.length-1]));	}	function getScriptPath()	{		var s = $.fileName;		return s.substring(0,s.lastIndexOf("/"));	}	var scriptName = getScriptName();	var cameraLayer = null;	var charPosLayer = null;	var targetColLayer = null;	var targetNull = null;		var targetID = 0;	var targetinPoint = 0;	var layerSortInPoint = function(a,b)	{		if (a.inPoint<b.inPoint) return -1;		if (a.inPoint>b.inPoint) return 1;			}//*************************//MainWindowvar winObj = ( me instanceof Panel) ? me : new Window("palette", getScriptName(), [0,0,0+222,0+100]  ,{resizeable:true, maximizeButton:true, minimizeButton:true});
//*************************//controlsvar lbCaption = winObj.add("statictext",[11, 11, 11+200, 11+12],getScriptName());var lbCaption2 = winObj.add("statictext",[11, 29, 11+200, 29+12],"塗・線を消す");var btnExec = winObj.add("button",[11, 57, 11+160, 57+23],"実行");//*************************var getLayer = function(){	var ret = null;	var ac = app.project.activeItem;	if (ac instanceof CompItem){		var lyrs = ac.selectedLayers;		if (lyrs.length !=1) {			alert ("レイヤは一つだけ選択してください");		}else{			if ( lyrs[0] instanceof ShapeLayer){				ret = lyrs[0];			}else{				alert ("シェイプにしたレイヤを選択してください");			}		}	}else{		alert ("コンポがアクティブになっていない!");	}	return ret;}//*************************var dellNURI = function(lyr){	var ret = false;	if ( !( lyr instanceof ShapeLayer)) return ret; 	var rg = lyr.property("ADBE Root Vectors Group");	if (rg.numProperties<=0){		alert("コンテンツがない");		return false;	}	for ( var i=1; i<=rg.numProperties;i++){		var t = rg.property(i);		if (t.matchName !="ADBE Vector Group") continue;		var t2 = t.property("ADBE Vectors Group");		if (t2.numProperties<=0) continue;				for ( var j  = t2.numProperties; j >=1; j--) {			var t3 = t2.property(j);			var mn = t3.matchName;			if ( (mn=="ADBE Vector Graphic - Fill")||(mn=="ADBE Vector Graphic - Stroke")) {				 t3.remove();			}		}		}	return true;}//*************************var exec = function(){		var tx = getLayer();	if (tx==null) return;	app.beginUndoGroup("生方かすみ-レイヤ統合");	dellNURI(tx);	app.endUndoGroup();}//*************************btnExec.onClick = exec;//window show	if ( ( me instanceof Panel) == false){
		winObj.center(); 
		winObj.show();
	}})(this);